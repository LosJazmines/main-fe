<div class="min-h-full">
  <!-- Header -->
  <!-- <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-semibold text-gray-700">Integrar Mercado Pago</h1>
    </div> 
     -->
  <div
    class="w-full flex flex-col lg:flex-row justify-between items-center mb-4 gap-4"
  >
    <h1 class="text-3xl mb-6 text-[#3a5a40] !font-playfair text-start w-full">
      Gestión de Cuentas MercadoPago
    </h1>

    <div
      class="w-full flex flex-col lg:flex-row justify-end items-center gap-4"
    >
      <!-- <app-search-moderno-reactive
        [inputPlaceholder]="'Buscar por Direccion o Nombre del destinatario'"
        (search)="handleSearch($event)"
        class="w-full lg:w-[400px]"
      ></app-search-moderno-reactive> -->
      <button
        (click)="openDialogAddProduct()"
        class="w-full lg:w-max px-4 py-2 bg-[#3a5a40]/80 text-white rounded-[4px] shadow hover:bg-[#3a5a40]/80 focus:outline-none transition flex items-center gap-2"
        [disabled]="isLoading"
      >
        <lucide-icon name="plus" class="w-5 h-5"></lucide-icon>
        Integrar cuenta de MercadoPago
      </button>
    </div>
  </div>

  <!-- Formulario de Integración -->
  <div class="bg-white shadow rounded-[4px] p-6 mb-6">
    <h2 class="text-xl font-semibold text-gray-700 mb-4">
      {{ isEdit ? 'Editar Cuenta' : 'Nueva Cuenta' }}
    </h2>
    <form [formGroup]="paymentForm" (ngSubmit)="onSubmit()">
      <!-- Credenciales de MercadoPago -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div>
          <label class="text-gray-500 block mb-1">Access Token</label>
          <input
            type="text"
            class="w-full p-2 border rounded-[4px]"
            formControlName="accessToken"
            placeholder="Ingresa tu Access Token"
            [class.border-red-500]="submitted && paymentForm.get('accessToken')?.errors"
          />
          <small
            class="text-red-500"
            *ngIf="
              (paymentForm.get('accessToken')?.invalid && paymentForm.get('accessToken')?.touched) ||
              (submitted && paymentForm.get('accessToken')?.errors)
            "
          >
            Este campo es obligatorio.
          </small>
        </div>
        <div>
          <label class="text-gray-500 block mb-1">Public Key</label>
          <input
            type="text"
            class="w-full p-2 border rounded-[4px]"
            formControlName="publicKey"
            placeholder="Ingresa tu Public Key"
            [class.border-red-500]="submitted && paymentForm.get('publicKey')?.errors"
          />
          <small
            class="text-red-500"
            *ngIf="
              (paymentForm.get('publicKey')?.invalid && paymentForm.get('publicKey')?.touched) ||
              (submitted && paymentForm.get('publicKey')?.errors)
            "
          >
            Este campo es obligatorio.
          </small>
        </div>
      </div>

      <!-- Información Adicional -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div>
          <label class="text-gray-500 block mb-1">Nombre del Local</label>
          <input
            type="text"
            class="w-full p-2 border rounded-[4px]"
            formControlName="storeName"
            placeholder="Ingresa el nombre del local"
            [class.border-red-500]="submitted && paymentForm.get('storeName')?.errors"
          />
          <small
            class="text-red-500"
            *ngIf="
              (paymentForm.get('storeName')?.invalid && paymentForm.get('storeName')?.touched) ||
              (submitted && paymentForm.get('storeName')?.errors)
            "
          >
            Este campo es obligatorio.
          </small>
        </div>
        <div>
          <label class="text-gray-500 block mb-1">Email de Contacto</label>
          <input
            type="email"
            class="w-full p-2 border rounded-[4px]"
            formControlName="contactEmail"
            placeholder="Ingresa un email para soporte"
            [class.border-red-500]="submitted && paymentForm.get('contactEmail')?.errors"
          />
          <small
            class="text-red-500"
            *ngIf="
              (paymentForm.get('contactEmail')?.invalid && paymentForm.get('contactEmail')?.touched) ||
              (submitted && paymentForm.get('contactEmail')?.errors)
            "
          >
            <span *ngIf="paymentForm.get('contactEmail')?.errors?.['required']">
              Este campo es obligatorio.
            </span>
            <span *ngIf="paymentForm.get('contactEmail')?.errors?.['email']">
              Ingresa un email válido.
            </span>
          </small>
        </div>
      </div>

      <!-- Botón de Guardar -->
      <div class="flex justify-end gap-2">
        <button
          type="button"
          (click)="resetForm()"
          class="cursor-pointer w-full lg:w-max px-4 py-2 bg-gray-200 text-gray-700 rounded-[4px] shadow hover:bg-gray-300 focus:outline-none transition flex items-center gap-2"
          [disabled]="isLoading"
        >
          <lucide-icon name="x" class="w-5 h-5"></lucide-icon>
          Cancelar
        </button>
        <button
          type="submit"
          [disabled]="paymentForm.invalid || isLoading"
          class="cursor-pointer w-full lg:w-max px-4 py-2 bg-[#3a5a40]/10 text-[#3a5a40] rounded-[4px] shadow hover:bg-[#3a5a40]/20 focus:outline-none transition flex items-center gap-2"
        >
          <lucide-icon 
            [name]="isLoading ? 'loader' : 'check'" 
            class="w-5 h-5"
            [class.animate-spin]="isLoading"
          ></lucide-icon>
          {{ isEdit ? 'Actualizar' : 'Guardar' }} Integración
        </button>
      </div>
    </form>
  </div>

  <!-- Cuentas Integradas -->
  <div
    *ngIf="accounts.length > 0; else noAccounts"
    class="bg-white shadow rounded-[4px] p-6"
  >
    <h2 class="text-xl font-semibold text-gray-700 mb-4">Cuentas Integradas</h2>
    <div class="overflow-x-auto">
      <table class="table-auto w-full border-collapse">
        <thead>
          <tr class="bg-gray-200 text-gray-600 text-sm uppercase text-left">
            <th class="p-3">ID</th>
            <th class="p-3">Nombre del Local</th>
            <th class="p-3">Email</th>
            <th class="p-3">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let account of accounts" class="border-t">
            <td class="p-3">{{ account.id }}</td>
            <td class="p-3">{{ account.storeName }}</td>
            <td class="p-3">{{ account.contactEmail }}</td>
            <td class="p-3">
              <button
                class="bg-yellow-500 text-white px-3 py-1 rounded-[4px] text-sm mr-2"
                (click)="onEdit(account, accounts.indexOf(account))"
                [disabled]="isLoading"
              >
                Editar
              </button>
              <button
                class="bg-red-500 text-white px-3 py-1 rounded-[4px] text-sm"
                (click)="onDelete(account.id)"
                [disabled]="isLoading"
              >
                Eliminar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <ng-template #noAccounts>
    <div class="bg-white shadow rounded-[4px] p-6 flex flex-col items-center">
      <lucide-icon name="info" class="text-4xl text-gray-400 mb-4"></lucide-icon>
      <h2 class="text-xl font-semibold text-gray-700 mb-2">
        Sin Cuentas Integradas
      </h2>
      <p class="text-gray-500 text-center">
        Integre una cuenta de MercadoPago para poder utilizar esta
        funcionalidad.
      </p>
    </div>
  </ng-template>
</div>
